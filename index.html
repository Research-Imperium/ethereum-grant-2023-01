<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8"/>
    <title>Ethereum grant application 2023 - Large Language Models for Anomaly Detection of EVM Transactions - Yu Gai, Liyi Zhou, Dawn Song, Arthur Gervais</title>
    <meta name="description" content="Ethereum grant application. Machine Learning on a network level to find anomalies and enable early warning systems for issues that start occurring."/>
    <meta name="keywords" content="blockchain, security, machine learning"/>
    <link rel="stylesheet" href="https://latex.now.sh/style.css">
</head>

<body>
<h1>Large Language Models for Anomaly Detection of EVM Transactions</h1>
<p class="author">
    Yu Gai, Liyi Zhou, Dawn Song, Arthur Gervais<br>
    <a href="https://twitter.com/dawnsongtweets">[Twitter Dawn]</a> <a href="https://twitter.com/HatforceSec">[Twitter Arthur]</a>
    <a href="https://arthurgervais.com">[Website Arthur]</a> <a href="https://rdi.berkeley.edu/">[Website Dawn]</a> 
    <a href="https://github.com/arthurgervais">[Github Arthur]</a>
    <a href="https://scholar.google.com.au/citations?user=xEXQBfMAAAAJ&hl=en">[Google Scholar - Arthur]</a><a href="https://scholar.google.com/citations?hl=en&user=84WzBlYAAAAJ">[Google Scholar - Dawn]</a>
    <br>
    Email: arthur (at) gervais (dot) cc<br> Last Update: February 26, 2023
</p>

<div class="abstract">
    <h2>Project Abstract</h2>
    <p style="text-align:left;">
        The proposed grant project aims to develop a dynamic and real-time approach for detecting anomalous pending transactions in Ethereum. The project will focus on building a tool called BlockGPT, which will use tracing representations of blockchain activity and train a scalable GPT-based language model to act as a real-time intrusion detection system. The goal is to overcome performance limitations that have hindered traditional methods and provide real-time transaction anomaly detection.

        The proposed tool will be designed and evaluated using Ethereum transactions. The project team will conduct experiments to demonstrate the effectiveness of the proposed tool in identifying abnormal transactions among a dataset of 68M transactions. As such the project will rank abnormal transactions given a dataset of <a href="https://eprint.iacr.org/2022/1773">124 attacks collected in previous work</a>. Finally, we will also measure the tool's throughput, in transactions per second.
    </p>
    <p style="text-align:left;">
        This work aims to make significant contributions to the field of blockchain transaction analysis by introducing a custom data encoding compatible with the GPT transformer, a domain-specific tokenization technique, and a tree encoding method specifically crafted for the EVM trace representation. The proposed grant project will enable the team to develop the BlockGPT tool for anomaly detection of EVM transactions, benefiting the blockchain industry and facilitating secure and efficient blockchain transactions.
    </p>
</div>

<main>
    <article>
        <h2 id="objectives">Objectives</h2>
        
        <p style="text-align:left;">
        With the increasing number of transactions per second processed by permissionless blockchains, the need for scalable and dynamic approaches to detect anomalous blockchain transactions is on the rise. Real-time anomaly detection for blockchain transactions, however, remains challenging due to significant manual engineering efforts required in traditional approaches. In this work, we aim to develop a dynamic and learning-based approach for transaction anomaly detection, utilizing Ethereum as an open dataset to train a transaction anomaly analysis tool, BlockGPT. Our objective is to elevate the art of blockchain security analysis into a dynamic, real-time endeavor, which can be used in a wide range of security-related tasks.
        </p>
        <p style="text-align:left;">
        Our proposed tool, BlockGPT, aims to generate efficient tracing representations of blockchain activity and is intended to be trained on a scalable GPT-based language model for anomaly detection. Our hypothesis is that we could potentially train a model to learn representations of transaction execution traces, which will help identify anomalous transactions. We will explore the efficacy of this approach with suitable detection or anomaly thresholds.
        </p>
        <p style="text-align:left;">
        We define the success of this project by the ability of BlockGPT to effectively identify anomalous transactions in real-time with high accuracy, and with a throughput of at least 100 transactions per second. We aim to evaluate the performance of BlockGPT on the Ethereum blockchain, extending a dataset covering attacks over a timeframe of four years. We will measure its effectiveness by ranking the identified abnormal transactions among the top-3 most abnormal transactions interacting with their victim contracts.
        </p>
        <p style="text-align:left;">
        This work aims to make significant contributions to the field of blockchain transaction analysis by introducing a custom data encoding compatible with the GPT transformer, a domain-specific tokenization technique, and a tree encoding method specifically crafted for the EVM trace representation. The proposed grant project will enable us to develop BlockGPT for anomaly detection of EVM transactions, benefiting the blockchain industry and facilitating secure and efficient blockchain transactions.
        </p>

        <h2 id="services">Outcomes</h2>
        <p style="text-align:left;">
        The proposed grant project, which aims to develop BlockGPT for anomaly detection of EVM transactions, will benefit the greater Ethereum ecosystem in several ways.

        <p style="text-align:left;">
        Firstly, BlockGPT will enhance the security of the Ethereum ecosystem by providing a dynamic, real-time approach to detecting anomalous transactions. By utilizing a scalable GPT-based language model and generating tracing representations of blockchain activity, BlockGPT can quickly identify abnormal transactions and trigger an early investigation or a smart contract pause mechanism to prevent an attack.
        </p>

        <p style="text-align:left;">
        Secondly, BlockGPT will provide a valuable tool for users, liquidity providers, speculators, and protocol operators in the Ethereum ecosystem, as it will help them avoid significant losses caused by attack transactions. Further, BlockGPT will create a list of abnormal transactions, potentially identifying new and previously unknown abnormal transactions. The dataset generated by BlockGPT will be transparent, timestamped, and non-repudiable, providing insights into user behavior and DApp interactions, which can be used to further improve the security of the Ethereum ecosystem.
        </p>

        <p style="text-align:left;">
        Thirdly, BlockGPT will introduce new methods and techniques for blockchain transaction analysis, such as a custom data encoding compatible with the GPT transformer, a domain-specific tokenization technique, and a tree encoding method specifically crafted for the EVM trace representation. These contributions will be beneficial for the broader blockchain community, as they can be adapted for other machine learning based blockchain transaction analysis.
        </p>
        <p style="text-align:left;">
        In summary, the BlockGPT project will benefit the greater Ethereum ecosystem by providing a real-time and scalable approach to detecting anomalous transactions, improving the security of the ecosystem, and introducing new methods and techniques for blockchain transaction analysis that can fundamentally shape blockchain security.
        </p>

        <h2 id="scope">Grant Scope</h2>

        <p style="text-align:left;">
        The proposed grant project aims to research and develop BlockGPT for anomaly detection of EVM transactions. The expected output of this research will be a dynamic and learning-based approach to detecting anomalous transactions in permissionless blockchains such as Ethereum. BlockGPT will be a real-time intrusion detection system that generates efficient tracing representations of blockchain activity and trains a scalable GPT-based language model for anomaly detection.
        </p>
        <p style="text-align:left;">
        We plan to evaluate the performance of BlockGPT by using it as an anomaly detection tool for Ethereum transactions, utilizing a dataset of 68M transactions and 124 attacks. The results of our evaluation will hopefully demonstrate the effectiveness of BlockGPT in identifying abnormal transactions. We will also evaluate the efficacy of this approach with suitable detection or anomaly thresholds to minimize false positives.
        </p>
        <p style="text-align:left;">
        We intend to make BlockGPT an open-source tool under a permissive license, together with the 68M transaction dataset and the 124 attacks, including the results from BlockGPT. This will enable other researchers and developers to use and build upon our work, further advancing the field of blockchain transaction analysis and improving the security and efficiency of blockchain transactions.
        </p>
        <p style="text-align:left;">
        We also plan to write a scientific paper containing all details of our research, including the development of BlockGPT, the evaluation of its performance, and the contributions it makes to the field of blockchain transaction analysis. This paper will be published in a reputable scientific journal or conference, providing a rigorous and transparent account of our research for the benefit of the broader blockchain community.
        </p>


        <h2 id="scope">Project Team</h2>
        The project team consists of four people, two professors and two PhD students.
        </p>
        <p style="text-align:left;">
        Arthur Gervais, Associate Professor at UCL, and Dawn Song, Professor at UC Berkeley, will be leading the project as the principal investigators. They will be responsible for the overall direction and management of the project, including the development of BlockGPT, the evaluation of its performance, and the writing of the scientific paper.
        </p>
        <p style="text-align:left;">
        The two PhD students working on the project are Liyi Zhou and Yu Gai. They will assist the principal investigators in developing and evaluating BlockGPT, as well as in writing the scientific paper.
        </p>


        <h2 id="scope">Background</h2>
        The project team has extensive experience in the field of blockchain and security research.

        <p style="text-align:left;">
        Arthur Gervais is an Associate Professor at University College London (UCL) and a leading expert in the field of blockchain security. He has published numerous papers on the security and privacy of blockchain systems, including <a href="https://eprint.iacr.org/2016/555">On the security and performance of proof of work blockchains</a>, a <a href="https://www.mlsec.org/topnotch/sec_top100.html">top-100 information security paper of all time</a>.
        </p>

        <p style="text-align:left;">
        Dawn Song is a Professor at the University of California, Berkeley, and a renowned expert in computer security and privacy. She has published over 100 research papers on various topics, including blockchain and security, and has won numerous awards for her contributions to the field. One of her recent projects is the Oasis Network, a privacy-enabled blockchain platform.
        </p>

        <p style="text-align:left;">
        Liyi Zhou is a PhD student at UCL, working with Arthur Gervais. He has previously worked on blockchain security and privacy research, including a recent paper on the <a href="https://arxiv.org/abs/2101.05511">Blockchain Dark forest</a>, and on recent <a href="https://eprint.iacr.org/2022/1773">DeFi Attacks</a>.
        </p>

        <p style="text-align:left;">
        Yu Gai is a PhD student at UC Berkeley, working under the supervision of Dawn Song. He has previously worked on machine learning research, with a focus on Deep and Graph Neural Networks. Yu in particular contributed to the <a href="https://arxiv.org/abs/1909.01315">Deep Graph Library</a>, a Graph-Centric, Highly-Performant Package for Graph Neural Networks.
        </p>

        The project team has also worked on various open-source and educational projects related to blockchain and security, including:
        <ul>
            <li><a href="https://defi-learning.org/">Massive Open Online Course on Decentralized Finance</a></li>
            <li><a href="https://www.youtube.com/playlist?list=PLS01nW3RtgoqeqHqOZ7NYdPR9CJRGZxf7">Podcast Fireside Chat with DeFi leaders</a></li>
            <li><a href="https://github.com/arthurgervais/Bitcoin-Simulator">Blockchain Network Simulator</a></li>
            <li><a href="http://www.blockchainworkbench.com">Blockchain Workbench, a solidity learning platform</a></li>
        </ul>

        In addition, the project team has published numerous papers in top-tier academic conferences and journals, including IEEE Symposium on Security and Privacy, USENIX Security Symposium, and ACM Conference on Computer and Communications Security. Overall, the project team has the necessary experience and expertise to undertake the proposed research project on developing and evaluating BlockGPT for anomaly detection of EVM transactions.

        <h2 id="scope">Methodology</h2>
        To achieve our research objectives, we plan to follow the following methodology:

        <ol>
            <li>
                <b>Develop BlockGPT:</b> We will develop BlockGPT, a dynamic and learning-based approach to detecting anomalous transactions in permissionless blockchains such as Ethereum. BlockGPT will be a real-time intrusion detection system that generates efficient tracing representations of blockchain activity and trains a scalable GPT-based language model for anomaly detection.
            </li>

            <li>
                <b>Train BlockGPT:</b> We will train BlockGPT using Ethereum as an open dataset, using a dataset of 68M transactions and their associated EVM traces. We will design a custom data encoding to be compatible with the GPT transformer, and a domain-specific tokenization technique for encoding EVM traces. We will also design and implement a tree encoding method that is specifically crafted for the EVM trace tree representation. This will allow us to capture any involved smart contract calls, function names, parameters, and storage modifications from the EVM trace.
            </li>

            <li>
                <b>Evaluate BlockGPT:</b> We will evaluate the performance of BlockGPT as a transaction anomaly analysis tool for Ethereum transactions. We will extend the dataset to include attacks over a timeframe of four years, spanning a total of 124 attacks and a total of 68M transactions. We will evaluate BlockGPT's ability to identify abnormal transactions and its real-time capabilities by measuring its throughput.
            </li>

            <li>
                <b>Write a scientific paper:</b> We will write a scientific paper detailing the development, evaluation, and contributions of BlockGPT to the field of blockchain transaction analysis. This paper will contain all the details of our research, including the development of BlockGPT, the evaluation of its performance, and the contributions it makes to the field of blockchain transaction analysis. We plan to publish the paper in a reputable scientific journal or conference.
            </li>

            <li>
                <b>Make BlockGPT open source:</b> We will make BlockGPT an open-source tool under a permissive license, together with the 68M transaction dataset and the 124 attacks, including the results from BlockGPT. This will enable other researchers and developers to use and build upon our work, further advancing the field of blockchain transaction analysis and improving the security and efficiency of blockchain transactions.
            </li>
        </ol>
        By following this methodology, we expect to achieve our research objectives of developing and evaluating BlockGPT for anomaly detection of EVM transactions, contributing to the field of blockchain transaction analysis, and improving the security and efficiency of blockchain transactions.

        <h2 id="scope">Timeline</h2>
        <p>The project is expected to take 12 months to complete, with the following timeline and milestones:</p>
        
        <p><b>Month 1-3:</b><br>
        - Develop BlockGPT: Design a custom data encoding to be compatible with the GPT transformer and a domain-specific tokenization technique for encoding EVM traces. Implement a tree encoding method that is specifically crafted for the EVM trace tree representation.<br>
        - Extract the dataset: Build the dataset of 68M transactions and their associated EVM traces. Extract the 124 attacks for this work.</p>
        <p><b>Month 4-6:</b><br>
        - Evaluate BlockGPT: Evaluate and improve BlockGPT's performance in identifying abnormal transactions in the Ethereum blockchain. Define success and performance metrics, draw corresponding plots.<br>
        </p>
        <p><b>Month 7-9:</b><br>
        - Write a scientific paper: Writing of a scientific paper detailing the development, evaluation, and contributions of BlockGPT to the field of blockchain transaction analysis. Include the evaluation results.
        </p>
        <p><b>Month 10-12:</b><br>
        - Make BlockGPT open source: Make BlockGPT an open-source tool under a permissive license, together with the 68M transaction dataset and the 124 attacks, including the results from BlockGPT. Polish and document the source code appropriate for an open source project.
        </p>
        
        <p><b>Expected deliverables:</b><br>
        - A scientific paper detailing the development, evaluation, and contributions of BlockGPT to the field of blockchain transaction analysis.<br>
        - An open-source tool of BlockGPT under a permissive license, together with the 68M transaction dataset and the 124 attacks.</p>
        
        <p><b>Funds breakdown:</b><br>
        - Personnel: The funds will be used to support students working on this project.<br>
        
        <h2 id="scope">Budget</h2>
        <p>For this project, we request partial support for the students working on this project, amounting to $72,000.</p>

    </article>
</main>

</body>

<hr>

<footer>
    <p>Made using <a href="https://latex.vercel.app">https://latex.vercel.app</a> &#10084; &#10084;</p>
</footer>

</html>